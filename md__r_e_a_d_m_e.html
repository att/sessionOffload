<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenOffload: Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenOffload
   &#160;<span id="projectnumber">v1</span>
   </div>
   <div id="projectbrief">Open gRPC API to enable hardware offload for network services</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The framework directory provides the C Language interface into the C++ gRPC OpneOffload Client and Server. Users of the OpenOffload client and server do not need to write any C++ code the interfaces are abstract through a C API for both the client and server.</p>
<p>There are simple test programs for the client and server. The server code includes a simpel in-memory hashtable that allows the construction of more complex test cases.</p>
<h1>System Requirements</h1>
<p>The current version of the programs are built for Centos 8. gRPC C++ must be installed and developer tools to build the system. A Vagrantfile is included in the distribution as an example of how to create a development environment. In addition a Dockerfile is included to build from a container.</p>
<p>It is recommended that the Dockerfile or Vagrant method be used at first to get up and running the quickest.</p>
<h2>Install Development tools</h2>
<div class="fragment"><div class="line">$ yum -y install wget</div>
<div class="line">$ yum -y group install &quot;Development Tools&quot;</div>
</div><!-- fragment --><h2>Install <a href="http://hyperrealm.github.io/libconfig/">libconfig</a></h2>
<p>Libconfig is used to configure test files the the test client only. <a href="https://github.com/hyperrealm/libconfig/blob/master/INSTALL">libconfig install instructions</a></p>
<div class="fragment"><div class="line">$ wget http://hyperrealm.github.io/libconfig/dist/libconfig-1.7.2.tar.gz</div>
<div class="line">$ tar xvzf libconfig-1.7.2.tar.gz</div>
<div class="line">$ cd libconfig-1.7.2</div>
<div class="line">$ ./configure</div>
<div class="line">$ make </div>
<div class="line">$ sudo make install</div>
</div><!-- fragment --><p> To configure you system to find the libconfig.so file </p><div class="fragment"><div class="line">$ vi /etc/ld.so.conf</div>
</div><!-- fragment --><p>and add the path to your install directory of libconfig. The default is /usr/local/lib so the file would look like this:</p>
<div class="fragment"><div class="line">include ld.so.conf.d/*.conf</div>
<div class="line">/usr/local/lib</div>
</div><!-- fragment --><p>Close the file and update the shared library config</p>
<div class="fragment"><div class="line">$ ldconfig </div>
</div><!-- fragment --><p>Check that the libconfig.so file is in config </p><div class="fragment"><div class="line">sudo ldconfig -p | grep libconfig</div>
</div><!-- fragment --><p>This will print out links to libconfig.so</p>
<h2>Install gRPC C++</h2>
<div class="fragment"><div class="line">$ mkdir -p $HOME/local</div>
<div class="line">$ export GRPC_INSTALL=$HOME/local</div>
<div class="line">$ wget --no-check-certificate -q -O cmake-linux.sh https://github.com/Kitware/CMake/releases/download/v3.17.5/cmake-3.17.5-Linux-x86_64.sh</div>
<div class="line">$ ./cmake-linux.sh  -- --skip-license --prefix=$HOME/local</div>
<div class="line">$ rm cmake-linux.sh</div>
<div class="line">$ export PATH=$GRPC_INSTALL/bin:$PATH</div>
<div class="line">$ git config --global  http.sslVerify false</div>
<div class="line">$ git clone --recurse-submodules -b v1.30.0 https://github.com/grpc/grpc</div>
<div class="line">$ cd grpc </div>
<div class="line">$ mkdir -p $GRPC_INSTALL/grpc/cmake/build</div>
<div class="line">$ pushd cmake/build</div>
<div class="line">$ cmake -DgRPC_INSTALL=ON \</div>
<div class="line">      -DgRPC_BUILD_TESTS=OFF \</div>
<div class="line">      -DCMAKE_INSTALL_PREFIX=$GRPC_INSTALL \</div>
<div class="line">      ../..</div>
<div class="line">$ make -j 4</div>
<div class="line">$ make install</div>
<div class="line">$ popd</div>
</div><!-- fragment --><h1>Test Programs</h1>
<h2>Build</h2>
<div class="fragment"><div class="line">$ cd &quot;Install Directory&quot;/sessionoffload/openoffload/cpp/framework</div>
<div class="line">$ make all</div>
</div><!-- fragment --> <h2>Run</h2>
<p>Checkout the test program capabilities</p>
<div class="fragment"><div class="line">$ bin/opof_client_test -h </div>
</div><!-- fragment --><p>Run the server</p>
<div class="fragment"><div class="line">$ bin/opof_server_test</div>
</div><!-- fragment --><p>Run the client for a speed tests</p>
<p>'n' in the number of sessions and 'b' is the buffer size to stream</p>
<div class="fragment"><div class="line">$ bin/opof_client_test -s -n 128 - b 64</div>
</div><!-- fragment --> <h2>Testing</h2>
<p>To run specific tests users can create configuration files and run them as specific tests. The configuration files are in the "config" directory.</p>
<div class="fragment"><div class="line">$ bin/opof_client_test -t 1 -c config/test1.cfg</div>
</div><!-- fragment --><h1>Programming the C Interface</h1>
<h2>Client Program</h2>
<p>There is an example file "opof_client_test.c" that shows how to use the C client interface. All the C++ enums and structures have been converted to C and are included from the file "opof.h". This is the major work for any changes to the openoffload.proto file. There may be a way to automate this but currently it is a manual process.</p>
<div class="fragment"><div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><span class="comment"> * you may not use this file except in compliance with the License.</span></div>
<div class="line"><span class="comment"> * You may obtain a copy of the License at:</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *     http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><span class="comment"> * See the License for the specific language governing permissions and</span></div>
<div class="line"><span class="comment"> * limitations under the License.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="preprocessor">#ifndef OPOF_H</span></div>
<div class="line"><span class="preprocessor">#define OPOF_H</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SUCCESS 0</span></div>
<div class="line"><span class="preprocessor">#define FAILURE -1</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span>  { </div>
<div class="line">  _HOPOPT = 0,</div>
<div class="line">  _TCP = 6,</div>
<div class="line">  _UDP = 17,</div>
<div class="line">} PROTOCOL_ID_T;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span>  {</div>
<div class="line">   _IPV4 = 0,</div>
<div class="line">   _IPV6 = 1,</div>
<div class="line">} IP_VERSION_T;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> {</div>
<div class="line">   _DROP = 0,</div>
<div class="line">   _FORWARD = 1,</div>
<div class="line">   _MIRROR = 2,</div>
<div class="line">   _SNOOP = 3,</div>
<div class="line"> } ACTION_VALUE_T;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> {</div>
<div class="line">  _ESTABLISHED = 0,</div>
<div class="line">  _CLOSING_1   = 1,</div>
<div class="line">  _CLOSING_2   = 2,</div>
<div class="line">  _CLOSED      = 3,</div>
<div class="line">} SESSION_STATE_T;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> {</div>
<div class="line">  _NOT_CLOSED = 0,</div>
<div class="line">  _FINACK     = 1,</div>
<div class="line">  _RST        = 2,</div>
<div class="line">  _TIMEOUT    = 3,</div>
<div class="line">} SESSION_CLOSE_T;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> {</div>
<div class="line">   <a class="code" href="opof_8h.html#a5b435c0ab389d1e89504351e7bab6b28a4dfce0e3a45d66604d8348690fe17315">_ACCEPTED</a> = 0,</div>
<div class="line">   <a class="code" href="opof_8h.html#a5b435c0ab389d1e89504351e7bab6b28a71a69ccce6e962ad25572b3e2f624a6f">_REJECTED</a> = 1,</div>
<div class="line">   _REJECTED_SESSION_NONEXISTENT = 2,</div>
<div class="line">   _REJECTED_SESSION_TABLE_FULL = 3,</div>
<div class="line">   _REJECTED_SESSION_ALREADY_EXISTS = 4,</div>
<div class="line">} <a class="code" href="opof_8h.html#a5b435c0ab389d1e89504351e7bab6b28">REQUEST_STATUS_T</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//typedef struct sessionRequestTuple {</span></div>
<div class="line"><span class="comment">//  int64_t  sessionId;</span></div>
<div class="line"><span class="comment">//} sessionRequest_t;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structadd_session_response_tuple.html">addSessionResponseTuple</a> {</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  sessionId;</div>
<div class="line">  <a class="code" href="opof_8h.html#a5b435c0ab389d1e89504351e7bab6b28">REQUEST_STATUS_T</a> requestStatus;</div>
<div class="line">  <span class="comment">//google.protobuf.Timestamp startTime = 3;</span></div>
<div class="line">} <a class="code" href="structadd_session_response__t.html">addSessionResponse_t</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsession_response_tuple.html">sessionResponseTuple</a> {</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> sessionId;</div>
<div class="line">    <span class="keywordtype">long</span>  inPackets;</div>
<div class="line">    <span class="keywordtype">long</span>  outPackets;</div>
<div class="line">    <span class="keywordtype">long</span>  inBytes;</div>
<div class="line">    <span class="keywordtype">long</span>  outBytes;</div>
<div class="line">    SESSION_STATE_T sessionState;</div>
<div class="line">    SESSION_CLOSE_T sessionCloseCode;</div>
<div class="line">    <a class="code" href="opof_8h.html#a5b435c0ab389d1e89504351e7bab6b28">REQUEST_STATUS_T</a> requestStatus;</div>
<div class="line">  <span class="comment">//google.protobuf.Timestamp startTime = 9;</span></div>
<div class="line">  <span class="comment">//google.protobuf.Timestamp endTime = 10;</span></div>
<div class="line">} <a class="code" href="structsession_response_tuple.html">sessionResponse_t</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsession_request_tuple.html">sessionRequestTuple</a> {</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> sessId;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inlif;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> outlif;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> srcIP;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dstIP;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> srcPort;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dstPort;</div>
<div class="line">    PROTOCOL_ID_T proto;</div>
<div class="line">    IP_VERSION_T ipver;</div>
<div class="line">    ACTION_VALUE_T actType;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nextHop;</div>
<div class="line">} <a class="code" href="structsession_request_tuple.html">sessionRequest_t</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif  </span><span class="comment">/* OPOF_H */</span><span class="preprocessor"></span></div>
<div class="ttc" id="aopof_8h_html_a5b435c0ab389d1e89504351e7bab6b28"><div class="ttname"><a href="opof_8h.html#a5b435c0ab389d1e89504351e7bab6b28">REQUEST_STATUS_T</a></div><div class="ttdeci">REQUEST_STATUS_T</div><div class="ttdef"><b>Definition:</b> opof.h:197</div></div>
<div class="ttc" id="aopof_8h_html_a5b435c0ab389d1e89504351e7bab6b28a4dfce0e3a45d66604d8348690fe17315"><div class="ttname"><a href="opof_8h.html#a5b435c0ab389d1e89504351e7bab6b28a4dfce0e3a45d66604d8348690fe17315">_ACCEPTED</a></div><div class="ttdeci">@ _ACCEPTED</div><div class="ttdef"><b>Definition:</b> opof.h:198</div></div>
<div class="ttc" id="aopof_8h_html_a5b435c0ab389d1e89504351e7bab6b28a71a69ccce6e962ad25572b3e2f624a6f"><div class="ttname"><a href="opof_8h.html#a5b435c0ab389d1e89504351e7bab6b28a71a69ccce6e962ad25572b3e2f624a6f">_REJECTED</a></div><div class="ttdeci">@ _REJECTED</div><div class="ttdef"><b>Definition:</b> opof.h:199</div></div>
<div class="ttc" id="astructadd_session_response__t_html"><div class="ttname"><a href="structadd_session_response__t.html">addSessionResponse_t</a></div></div>
<div class="ttc" id="astructadd_session_response_tuple_html"><div class="ttname"><a href="structadd_session_response_tuple.html">addSessionResponseTuple</a></div><div class="ttdef"><b>Definition:</b> opof.h:247</div></div>
<div class="ttc" id="astructsession_request_tuple_html"><div class="ttname"><a href="structsession_request_tuple.html">sessionRequestTuple</a></div><div class="ttdef"><b>Definition:</b> opof.h:282</div></div>
<div class="ttc" id="astructsession_response_tuple_html"><div class="ttname"><a href="structsession_response_tuple.html">sessionResponseTuple</a></div><div class="ttdef"><b>Definition:</b> opof.h:255</div></div>
</div><!-- fragment --><h3>Initializing the client</h3>
<p>Initializing the client interface is as follows:</p>
<div class="fragment"><div class="line"><a class="code" href="structsession_table.html">sessionTable_t</a> *handle;</div>
<div class="line">handle = <a class="code" href="group__clientcinterface.html#ga9c69745900eb37547f04d26f9a18e8c2">opof_create_sessionTable</a>(address, port, cert);</div>
<div class="ttc" id="agroup__clientcinterface_html_ga9c69745900eb37547f04d26f9a18e8c2"><div class="ttname"><a href="group__clientcinterface.html#ga9c69745900eb37547f04d26f9a18e8c2">opof_create_sessionTable</a></div><div class="ttdeci">sessionTable_t * opof_create_sessionTable(const char *host, unsigned int port, const char *public_key)</div><div class="ttdoc">Entry point for C Inteface to C++ Class structure.</div><div class="ttdef"><b>Definition:</b> opof_clientlib.cc:48</div></div>
<div class="ttc" id="astructsession_table_html"><div class="ttname"><a href="structsession_table.html">sessionTable</a></div><div class="ttdef"><b>Definition:</b> opof_clientlib.cc:31</div></div>
</div><!-- fragment --><p> The address is a string representing the address of the server and the port is an int giving the port the server is listening on.</p>
<h3>Adding a session</h3>
<div class="fragment"><div class="line">status = <a class="code" href="group__clientcinterface.html#gabec96808e497387fde687aeb8a6b502a">opof_add_session</a>(handle, &amp;parameters, &amp;addResp);</div>
<div class="ttc" id="agroup__clientcinterface_html_gabec96808e497387fde687aeb8a6b502a"><div class="ttname"><a href="group__clientcinterface.html#gabec96808e497387fde687aeb8a6b502a">opof_add_session</a></div><div class="ttdeci">int opof_add_session(int size, sessionTable_t *sessionHandle, sessionRequest_t **parameters, addSessionResponse_t *resp)</div><div class="ttdoc">Add sessions to the offload device in batches of up to 64.</div><div class="ttdef"><b>Definition:</b> opof_clientlib.cc:109</div></div>
</div><!-- fragment --><h3>Getting a session</h3>
<div class="fragment"><div class="line">status = <a class="code" href="group__clientcinterface.html#gacbea9091d5586d8de6c652462cf60c34">opof_get_session</a>(handle, sessionId, &amp;resp);</div>
<div class="ttc" id="agroup__clientcinterface_html_gacbea9091d5586d8de6c652462cf60c34"><div class="ttname"><a href="group__clientcinterface.html#gacbea9091d5586d8de6c652462cf60c34">opof_get_session</a></div><div class="ttdeci">int opof_get_session(sessionTable_t *sessionHandle, unsigned long sessionId, sessionResponse_t *resp)</div><div class="ttdoc">Get a session from the offload device.</div><div class="ttdef"><b>Definition:</b> opof_clientlib.cc:129</div></div>
</div><!-- fragment --><h3>Deleting a session</h3>
<div class="fragment"><div class="line">status = <a class="code" href="group__clientcinterface.html#ga93dd42023c9bf5b81e51b355958d5dc7">opof_del_session</a>(handle, sessionId, &amp;resp);</div>
<div class="ttc" id="agroup__clientcinterface_html_ga93dd42023c9bf5b81e51b355958d5dc7"><div class="ttname"><a href="group__clientcinterface.html#ga93dd42023c9bf5b81e51b355958d5dc7">opof_del_session</a></div><div class="ttdeci">int opof_del_session(sessionTable_t *sessionHandle, unsigned long sessionId, sessionResponse_t *resp)</div><div class="ttdoc">Delete a session from the offload device.</div><div class="ttdef"><b>Definition:</b> opof_clientlib.cc:149</div></div>
</div><!-- fragment --> <h3>Extending the server</h3>
<p>The server is started by calling</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> opof_server(<span class="keyword">const</span> <span class="keywordtype">char</span>* address, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> port, <span class="keyword">const</span> <span class="keywordtype">char</span>* cert, <span class="keyword">const</span> <span class="keywordtype">char</span>* key)</div>
</div><!-- fragment --><p>To implement the interfaces to the server the following functions defined in "<a class="el" href="opof__serverlib_8h_source.html">opof_serverlib.h</a>' need to be implemented</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="group__servercinterface.html#ga40829134a06958cb89d8158372901d03">opof_add_session_server</a>(<a class="code" href="structsession_request_tuple.html">sessionRequest_t</a> *parameters, <a class="code" href="structadd_session_response__t.html">addSessionResponse_t</a> *response);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="group__servercinterface.html#gadd70e9f4f7e11368c8e5e358fa90bfdd">opof_get_session_server</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> sessionId, <a class="code" href="structsession_response_tuple.html">sessionResponse_t</a> *response);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="group__servercinterface.html#gad0d7b4f81c74e9f232b0b25934814bec">opof_del_session_server</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> sessionId, <a class="code" href="structsession_response_tuple.html">sessionResponse_t</a> *response);</div>
<div class="line"><a class="code" href="structsession_response_tuple.html">sessionResponse_t</a> **<a class="code" href="group__servercinterface.html#ga43ae93f40d3f3583bf9f675e60c41d37">opof_get_closed_sessions_server</a>(<a class="code" href="structstatistics_request_args__t.html">statisticsRequestArgs_t</a> *request, <span class="keywordtype">int</span> *sessionCount);</div>
<div class="ttc" id="agroup__servercinterface_html_ga40829134a06958cb89d8158372901d03"><div class="ttname"><a href="group__servercinterface.html#ga40829134a06958cb89d8158372901d03">opof_add_session_server</a></div><div class="ttdeci">int opof_add_session_server(sessionRequest_t *parameters, addSessionResponse_t *response)</div><div class="ttdoc">Utility fumction to add sessions to the test hashtable.</div><div class="ttdef"><b>Definition:</b> opof_server_test.c:137</div></div>
<div class="ttc" id="agroup__servercinterface_html_ga43ae93f40d3f3583bf9f675e60c41d37"><div class="ttname"><a href="group__servercinterface.html#ga43ae93f40d3f3583bf9f675e60c41d37">opof_get_closed_sessions_server</a></div><div class="ttdeci">int opof_get_closed_sessions_server(statisticsRequestArgs_t *request, sessionResponse_t responses[])</div><div class="ttdoc">Utility fumction to get closed sessions from test hashtable.</div><div class="ttdef"><b>Definition:</b> opof_server_test.c:272</div></div>
<div class="ttc" id="agroup__servercinterface_html_gad0d7b4f81c74e9f232b0b25934814bec"><div class="ttname"><a href="group__servercinterface.html#gad0d7b4f81c74e9f232b0b25934814bec">opof_del_session_server</a></div><div class="ttdeci">int opof_del_session_server(unsigned long sessionId, sessionResponse_t *response)</div><div class="ttdoc">Utility fumction to delete a session from the test hashtable.</div><div class="ttdef"><b>Definition:</b> opof_server_test.c:236</div></div>
<div class="ttc" id="agroup__servercinterface_html_gadd70e9f4f7e11368c8e5e358fa90bfdd"><div class="ttname"><a href="group__servercinterface.html#gadd70e9f4f7e11368c8e5e358fa90bfdd">opof_get_session_server</a></div><div class="ttdeci">int opof_get_session_server(unsigned long sessionId, sessionResponse_t *response)</div><div class="ttdoc">Utility fumction to get a session from test hashtable.</div><div class="ttdef"><b>Definition:</b> opof_server_test.c:203</div></div>
<div class="ttc" id="astructstatistics_request_args__t_html"><div class="ttname"><a href="structstatistics_request_args__t.html">statisticsRequestArgs_t</a></div><div class="ttdef"><b>Definition:</b> opof.h:277</div></div>
</div><!-- fragment --><p> The file "opof_server_test.c" is a sample implementation of each of the functions. The sample implementaton implements a simple in memory hashtable to enable more complex test scenarios to be implemented.</p>
<h1>Building from dockerfiles</h1>
<h2>Step 1</h2>
<p>Create the basic build image with all the required libraries</p>
<div class="fragment"><div class="line">$ cd openoffload/cpp/framework/build</div>
<div class="line">$ docker build -t grpcbuild:v1 .</div>
</div><!-- fragment --> <h2>Step 2</h2>
<p>Create the build container from the base image There is a little hack necessary to get the proto file in the right place for docker</p>
<div class="fragment"><div class="line">$ cd ..</div>
<div class="line">$ cp ../../../protos/openoffload.proto .</div>
</div><!-- fragment --> <div class="fragment"><div class="line">$ docker build -t opofbld:v1 .</div>
<div class="line">$ docker image ls</div>
</div><!-- fragment --> <h2>Step 3</h2>
<p>Access the container to get the files</p>
<div class="fragment"><div class="line">$ mkdir results</div>
<div class="line">$ docker create -it --name results opofbld:v1 /bin/bash</div>
<div class="line">$ docker cp results:/home/grpc/local/tests/bin/ results/</div>
<div class="line">$ cd results</div>
<div class="line">$ mkdir log</div>
</div><!-- fragment --><p>Start the server (optionally set -p port, -a address ) </p><div class="fragment"><div class="line">$ ./bin/opof_server_test</div>
<div class="line"> </div>
<div class="line">OPOF: Starting OPOF Version  0.1</div>
<div class="line">Info: Creating Insecure Server</div>
<div class="line">Server listening on: localhost:3443</div>
</div><!-- fragment --><p> Check the client main program for the available performance and config tests to run </p><div class="fragment"><div class="line">$ ./bin/opof_client_test -f -v</div>
</div><!-- fragment --> <h1>References</h1>
<ol type="1">
<li><a href="https://grpc.io/docs/languages/cpp/quickstart/">gRPC Quick Start Install</a></li>
<li><a href="https://troydhanson.github.io/uthash/userguide.html">uthash Documentation</a> </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
